                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=1012.98..1013.09 rows=4 width=201) (actual time=43.004..46.228 rows=1530 loops=1)
   Group Key: app_token_permission_global.private_id, app_token_global.public_id
   ->  Sort  (cost=1012.98..1012.99 rows=4 width=233) (actual time=42.979..43.062 rows=1530 loops=1)
         Sort Key: app_token_permission_global.private_id
         Sort Method: quicksort  Memory: 455kB
         ->  Nested Loop Left Join  (cost=19.53..1012.94 rows=4 width=233) (actual time=0.511..40.518 rows=1530 loops=1)
               ->  Nested Loop Left Join  (cost=19.26..1011.56 rows=4 width=233) (actual time=0.501..36.597 rows=1530 loops=1)
                     ->  Nested Loop Left Join  (cost=14.90..955.33 rows=3 width=201) (actual time=0.486..30.498 rows=1530 loops=1)
                           ->  Nested Loop Left Join  (cost=14.75..954.59 rows=3 width=201) (actual time=0.471..29.754 rows=1530 loops=1)
                                 ->  Nested Loop  (cost=13.44..934.49 rows=3 width=169) (actual time=0.460..26.702 rows=1530 loops=1)
                                       ->  Index Only Scan using app_token_global_pkey on app_token_global  (cost=0.15..8.17 rows=1 width=32) (actual time=0.025..0.029 rows=1 loops=1)
                                             Index Cond: (public_id = 'at_global_comprehensive'::text)
                                             Heap Fetches: 1
                                       ->  Nested Loop  (cost=13.29..926.30 rows=3 width=169) (actual time=0.428..26.417 rows=1530 loops=1)
                                             ->  Bitmap Heap Scan on app_token_permission_global  (cost=4.33..22.10 rows=7 width=137) (actual time=0.282..0.530 rows=1530 loops=1)
                                                   Recheck Cond: ((app_token_id)::text = 'at_global_comprehensive'::text)
                                                   Heap Blocks: exact=28
                                                   ->  Bitmap Index Scan on app_token_permission_global_app_token_id_idx  (cost=0.00..4.33 rows=7 width=0) (actual time=0.211..0.212 rows=1530 loops=1)
                                                         Index Cond: ((app_token_id)::text = 'at_global_comprehensive'::text)
                                             ->  Nested Loop  (cost=8.96..129.04 rows=13 width=64) (actual time=0.008..0.015 rows=1 loops=1530)
                                                   ->  Bitmap Heap Scan on iam_grant  (cost=8.54..19.26 rows=13 width=32) (actual time=0.003..0.003 rows=3 loops=1530)
                                                         Recheck Cond: (resource = ANY ('{*,role,unknown}'::text[]))
                                                         Heap Blocks: exact=1530
                                                         ->  Bitmap Index Scan on iam_grant_resource_ix  (cost=0.00..8.54 rows=13 width=0) (actual time=0.002..0.002 rows=3 loops=1530)
                                                               Index Cond: (resource = ANY ('{*,role,unknown}'::text[]))
                                                   ->  Index Only Scan using app_token_permission_grant_pkey on app_token_permission_grant  (cost=0.41..8.43 rows=1 width=64) (actual time=0.004..0.004 rows=0 loops=4590)
                                                         Index Cond: ((permission_id = (app_token_permission_global.private_id)::text) AND (canonical_grant = (iam_grant.canonical_grant)::text))
                                                         Heap Fetches: 1530
                                 ->  Bitmap Heap Scan on app_token_permission_global_individual_org_grant_scope  (cost=1.32..6.67 rows=3 width=64) (actual time=0.001..0.001 rows=0 loops=1530)
                                       Recheck Cond: ((app_token_permission_global.private_id)::text = (permission_id)::text)
                                       Heap Blocks: exact=30
                                       ->  Bitmap Index Scan on app_token_permission_global_individual_org_grant_scope_pkey  (cost=0.00..1.32 rows=3 width=0) (actual time=0.001..0.001 rows=0 loops=1530)
                                             Index Cond: ((permission_id)::text = (app_token_permission_global.private_id)::text)
                           ->  Index Only Scan using iam_scope_org_pkey on iam_scope_org  (cost=0.15..0.25 rows=1 width=32) (actual time=0.000..0.000 rows=0 loops=1530)
                                 Index Cond: (scope_id = (app_token_permission_global_individual_org_grant_scope.scope_id)::text)
                                 Heap Fetches: 30
                     ->  Bitmap Heap Scan on app_token_permission_global_individual_project_grant_scope  (cost=4.36..18.64 rows=10 width=64) (actual time=0.003..0.003 rows=1 loops=1530)
                           Recheck Cond: ((app_token_permission_global.private_id)::text = (permission_id)::text)
                           Heap Blocks: exact=1500
                           ->  Bitmap Index Scan on app_token_permission_global_individual_project_grant_scope_pkey  (cost=0.00..4.35 rows=10 width=0) (actual time=0.002..0.002 rows=1 loops=1530)
                                 Index Cond: ((permission_id)::text = (app_token_permission_global.private_id)::text)
               ->  Index Only Scan using iam_scope_project_scope_id_uq on iam_scope_project  (cost=0.28..0.35 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=1530)
                     Index Cond: (scope_id = (app_token_permission_global_individual_project_grant_scope.scope_id)::text)
                     Heap Fetches: 1500
 Planning Time: 2.543 ms
 Execution Time: 46.614 ms
