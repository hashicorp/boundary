                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=992.14..992.25 rows=4 width=201) (actual time=10.208..12.307 rows=30 loops=1)
   Group Key: app_token_permission_global.private_id, app_token_global.public_id
   ->  Sort  (cost=992.14..992.15 rows=4 width=201) (actual time=9.987..10.111 rows=1500 loops=1)
         Sort Key: app_token_permission_global.private_id
         Sort Method: quicksort  Memory: 447kB
         ->  Nested Loop Left Join  (cost=18.07..992.10 rows=4 width=201) (actual time=0.645..8.113 rows=1500 loops=1)
               ->  Nested Loop Left Join  (cost=17.79..990.72 rows=4 width=201) (actual time=0.609..3.204 rows=1500 loops=1)
                     ->  Nested Loop  (cost=13.44..934.49 rows=3 width=169) (actual time=0.551..1.273 rows=30 loops=1)
                           ->  Index Only Scan using app_token_global_pkey on app_token_global  (cost=0.15..8.17 rows=1 width=32) (actual time=0.155..0.158 rows=1 loops=1)
                                 Index Cond: (public_id = 'at_global_children_per_org'::text)
                                 Heap Fetches: 1
                           ->  Nested Loop  (cost=13.29..926.30 rows=3 width=169) (actual time=0.378..1.087 rows=30 loops=1)
                                 ->  Bitmap Heap Scan on app_token_permission_global  (cost=4.33..22.10 rows=7 width=137) (actual time=0.153..0.193 rows=30 loops=1)
                                       Recheck Cond: ((app_token_id)::text = 'at_global_children_per_org'::text)
                                       Heap Blocks: exact=2
                                       ->  Bitmap Index Scan on app_token_permission_global_app_token_id_idx  (cost=0.00..4.33 rows=7 width=0) (actual time=0.099..0.099 rows=30 loops=1)
                                             Index Cond: ((app_token_id)::text = 'at_global_children_per_org'::text)
                                 ->  Nested Loop  (cost=8.96..129.04 rows=13 width=64) (actual time=0.019..0.025 rows=1 loops=30)
                                       ->  Bitmap Heap Scan on iam_grant  (cost=8.54..19.26 rows=13 width=32) (actual time=0.006..0.007 rows=3 loops=30)
                                             Recheck Cond: (resource = ANY ('{*,user,unknown}'::text[]))
                                             Heap Blocks: exact=30
                                             ->  Bitmap Index Scan on iam_grant_resource_ix  (cost=0.00..8.54 rows=13 width=0) (actual time=0.004..0.004 rows=3 loops=30)
                                                   Index Cond: (resource = ANY ('{*,user,unknown}'::text[]))
                                       ->  Index Only Scan using app_token_permission_grant_pkey on app_token_permission_grant  (cost=0.41..8.43 rows=1 width=64) (actual time=0.005..0.005 rows=0 loops=90)
                                             Index Cond: ((permission_id = (app_token_permission_global.private_id)::text) AND (canonical_grant = (iam_grant.canonical_grant)::text))
                                             Heap Fetches: 30
                     ->  Bitmap Heap Scan on app_token_permission_global_individual_project_grant_scope proj_grants  (cost=4.36..18.64 rows=10 width=64) (actual time=0.031..0.039 rows=50 loops=30)
                           Recheck Cond: ((app_token_permission_global.private_id)::text = (permission_id)::text)
                           Heap Blocks: exact=47
                           ->  Bitmap Index Scan on app_token_permission_global_individual_project_grant_scope_pkey  (cost=0.00..4.35 rows=10 width=0) (actual time=0.026..0.026 rows=50 loops=30)
                                 Index Cond: ((permission_id)::text = (app_token_permission_global.private_id)::text)
               ->  Index Only Scan using iam_scope_project_scope_id_uq on iam_scope_project  (cost=0.28..0.35 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=1500)
                     Index Cond: (scope_id = (proj_grants.scope_id)::text)
                     Heap Fetches: 1500
 Planning Time: 3.522 ms
 Execution Time: 12.901 ms
