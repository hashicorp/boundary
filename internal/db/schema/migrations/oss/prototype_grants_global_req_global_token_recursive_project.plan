                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=116.12..116.41 rows=9 width=169) (actual time=11.335..15.387 rows=1500 loops=1)
   Group Key: token_permissions.private_id, token_permissions.description, token_permissions.create_time, token_permissions.grant_this_scope, token_permissions.grant_scope, token_permissions.app_token_id
   CTE token_permissions
     ->  Nested Loop  (cost=4.48..30.35 rows=7 width=137) (actual time=0.273..0.806 rows=1530 loops=1)
           ->  Index Only Scan using app_token_global_pkey on app_token_global  (cost=0.15..8.17 rows=1 width=32) (actual time=0.090..0.094 rows=1 loops=1)
                 Index Cond: (public_id = 'at_global_comprehensive'::text)
                 Heap Fetches: 1
           ->  Bitmap Heap Scan on app_token_permission_global  (cost=4.33..22.12 rows=7 width=137) (actual time=0.174..0.493 rows=1530 loops=1)
                 Recheck Cond: ((app_token_id)::text = 'at_global_comprehensive'::text)
                 Filter: (grant_scope <> 'children'::text)
                 Heap Blocks: exact=28
                 ->  Bitmap Index Scan on app_token_permission_global_app_token_id_idx  (cost=0.00..4.33 rows=7 width=0) (actual time=0.145..0.145 rows=1530 loops=1)
                       Index Cond: ((app_token_id)::text = 'at_global_comprehensive'::text)
   ->  Sort  (cost=85.76..85.79 rows=9 width=169) (actual time=11.268..11.422 rows=1500 loops=1)
         Sort Key: token_permissions.private_id, token_permissions.description, token_permissions.create_time, token_permissions.grant_this_scope, token_permissions.grant_scope, token_permissions.app_token_id
         Sort Method: quicksort  Memory: 447kB
         ->  Hash Join  (cost=26.02..85.62 rows=9 width=169) (actual time=3.137..7.250 rows=1500 loops=1)
               Hash Cond: ((project_grants.permission_id)::text = (token_permissions_1.private_id)::text)
               ->  Hash Join  (cost=25.79..85.35 rows=9 width=201) (actual time=1.158..4.432 rows=1500 loops=1)
                     Hash Cond: ((project_grants.permission_id)::text = (token_permissions.private_id)::text)
                     ->  Hash Join  (cost=25.56..84.09 rows=252 width=64) (actual time=0.621..2.653 rows=3000 loops=1)
                           Hash Cond: ((project_grants.scope_id)::text = (iam_scope.public_id)::text)
                           ->  Seq Scan on app_token_permission_global_individual_project_grant_scope project_grants  (cost=0.00..53.13 rows=2013 width=64) (actual time=0.012..0.521 rows=3000 loops=1)
                           ->  Hash  (cost=25.25..25.25 rows=25 width=7) (actual time=0.598..0.599 rows=1531 loops=1)
                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 85kB
                                 ->  Seq Scan on iam_scope  (cost=0.00..25.25 rows=25 width=7) (actual time=0.005..0.278 rows=1531 loops=1)
                     ->  Hash  (cost=0.14..0.14 rows=7 width=137) (actual time=0.517..0.518 rows=1530 loops=1)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 238kB
                           ->  CTE Scan on token_permissions  (cost=0.00..0.14 rows=7 width=137) (actual time=0.001..0.179 rows=1530 loops=1)
               ->  Hash  (cost=0.14..0.14 rows=7 width=32) (actual time=1.947..1.948 rows=1530 loops=1)
                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 99kB
                     ->  CTE Scan on token_permissions token_permissions_1  (cost=0.00..0.14 rows=7 width=32) (actual time=0.282..1.565 rows=1530 loops=1)
 Planning Time: 1.944 ms
 Execution Time: 16.157 ms
