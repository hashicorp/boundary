---
layout: docs
page_title: Transparent sessions
description: |-
  Learn how transparent sessions enable you to connect to Boundary resources without remembering resource IDs or port numbers.
---

# Transparent sessions

@include 'alerts/enterprise-only.mdx'

@include 'alerts/beta.mdx'

Transparent sessions shift Boundary from an active connection model to a passive connection model.
Boundary operates in the background instead of requiring you to remember specific resource IDs or ephemeral ports to connect to targets.
As long as Boundary authenticates a user and the user is authorized to access the target, Boundary intercepts the DNS call and routes traffic through a session automatically.

Transparent sessions require [aliases](/docs/concepts/aliases) and a DNS client named [Boundary Client Agent](/docs/api-clients/client-agent).

The Boundary Desktop client facilitates quick target discovery and session establishment using your preferred client.
If you configure aliases for your targets, install the Boundary Client Agent, and ensure you are authenticated to the cluster, connections are transparent to the user.
Boundary provides OS notifications to make it clear when you connect to a target using a transparent session.

## Configure transparent sessions

To configure transparent sessions for the public beta, you should ensure that the Boundary CLI and Boundary Desktop are not installed in the environment in which you want to run the transparent sessions beta.
If the Boundary CLI or Boundary Desktop are installed in the environment, you should uninstall them.

Boundary supports Windows and MacOs for the transparent sessions public beta.

### Requirements

Before you configure transparent sessions, you must:

- Ensure that the Boundary CLI and Boundary Desktop are not installed in the environment in which you want to run the transparent sessions beta.
- Download the appropriate installer for your Windows or MacOS environment from the [downloads](/boundary/install) page.

### Install clients

Complete the following steps to install the Boundary Client Agent, CLI, and Desktop client:

1. Install Boundary using the installer.
Make sure to select the options **Boundary Client Agent**, **CLI**, and **Desktop**.
1. Open the CLI and type the following command to confirm that the version is 0.16.0:
   ```
   $ boundary version
   ```
1. In the CLI, type the following command and confirm that the default DNS address is in the 100.x.y.z. rnage:
   - **MacOS**:
     ```
     $ scutil --dns
     ```
   - **Windows**:
     ```
     $ Get-DnsClientServerAddress
     ```

### Configure targets

The following section details how to configure targets and test the transparent sessions public beta feature.

If you use a cluster that was created earlier than release 0.16.0, you must add the grant `list-resolvable-aliases` so that the client agent can populate the local alias cache.
As an example, you could add `type=user;actions=list-resolvable-aliases;ids=*`.

If you use Boundary Enterprise, you can run Boundary in [dev mode](/docs/getting-started/dev-mode/dev-mode) to test transparent sessions.
Dev mode creates a temporary instance of Boundary that includes a Postgres database and a Boundary controller and worker.
It also automatically creates sample targets that are enabled for transparent sessions.

<details><summary><strong>Click here for more information about using dev mode</strong></summary>

Run the following command to start Boundary in dev mode:

```
$ boundary dev -worker-dns-server udp://8.8.8.8:53
```

You can use the follwoing sample targets to test transparent sessions:

Local Postgres target:
- **Description**: A local Postgres target.
You can connect to it using the flag `-dbname boundary`.
- **Alias value**: `postgres.boundary.dev`
- **Usage**: Use the following command to connect to this target using the CLI or client of your choice:

  ```shell-session
  $ psql postgresql://postgres:postgres@postgres.boundary.dev/boundary`
  ```

Local SSH target:
- **Description**: A localhost target that you can connect to using SSH and an alias.
Make sure you have a local SSH server running to connect to this target, or modify the target definition to point to an SSH server of your choice.
- **Alias value**: `ssh.boundary.dev`
- **Usage**: Use the following command to connect to this target using the CLI or client of your choice:

  ```shell-session
  $ ssh <my_username>@ssh.boundary.dev
  ```

  If you configured the SSH target for credential injection, Boundary should not prompt you for credentials.

Web target:
- **Description**: A web target using an address in Boundary.
Only HTTPS is supported, as this target uses port 442.
Alias values for web targets should match the target's URL.
- **Alias value**: `www.hashicorp.com`
- **Usage**: Enter `https://www.hashicorp.com` in the browser.
Validate that Boundary created the session using the following command:

  ```shell-session
  $ boundary sessions list -recursive
  ```

</details>

Complete the following steps to configure targets and test transparent sessions:

1. Authenticate to Boundary using the CLI or Desktop client.
1. [Create a new target with an alias](/docs/concepts/aliases#create-an-alias-during-target-creation) or [create an alias for an existing target](/docs/concepts/aliases#create-an-alias-for-an-existing-target).
Ensure that you have authorization to establish a session to the target.
1. Open the client of your choice and [connect to your target using the alias](/docs/concepts/aliases#connect-to-a-target-using-an-alias).

   Boundary routes your session using the Boundary Client Agent.
   You can validate that Boundary routed the session by looking at the **Sessions** page in the Desktop client or by typing `boundary sessions list -recursive` in the CLI.

When you have validated that transparent sessions work, you can create and establish transparent sessions to other services.
Make a list of the services you use, add these resources to Boundary as targets, and create workers as needed.

## Known issues

Refer to the following table for known issues that may affect the public beta:

| Issue | Description |
| ----- | ----------- |
| Brokered credentials are not cleaned up | After you end a transparent session, the credentials that you used to establish the session persist in Boundary. You can use the credentials to connect to the target even after the session ends. |
| SSH session is still active after exiting | When you use the terminal to create a transparent SSH session into a target session, and then end the session, it may remain active in Boundary. |
| Connection is reset when trying to reconnect | If you use an SSH transparent session and then cancel the connection, you may have trouble reconnecting until Boundary cleans up the session. |
| SSH connection fails with man-in-the-middle warning | On Ubuntu systems, the initial transparent session may be successful, but any subsequent connections prompt a warning that you may be experiencing a man-in-the-middle attack. |
| Boundary Client Agent authentication does not persist across restarts | When you reboot, you are required to re-authenticate to the Client Agent before you can use transparent sessions. |

## Conflicting software

Some software is known to cause conflicts with the Boundary Client Agent.
The following sections are an incomplete list of potential conflicts and any available workarounds for issues.

### Docker Desktop (MacOS)

Docker Desktop sometimes creates a local DNS listener that prevents the Client Agent from running.
If you run Docker Desktop 4.26 or later, you must clear the `Use kernel networking for UDP` option.
Otherwise, the Client Agent refuses to start.

### Palo Alto Networking Global Protect VPN

If you are unable to establish a transparent session while using the Palo Alto Networking Global Protect VPN, you may need to explicitly specify a network interface and the upstream DNS server(s) to use.

By default, the Client Agent reads the primary network interface's DNS server configuration and uses that information to resolve domains that are not configured as aliases in Boundary.
If the VPN configuration includes custom DNS servers, this information may not be available to the Client Agent, so you must explicitly specify the DNS server(s) to use.

To configure the DNS server(s) to use, use the `override_upstream_dns_servers` configuration option:

```hcl
# The DNS servers must be specified as an IP, or an IP:Port.
# If no port is provided, port 53 is assumed.
# The order of the entries specifies the priority.
override_upstream_dns_servers = [
   "8.8.8.8",
   "8.8.4.4:53",
]
```

### MacOS

By default, the Client Agent creates IPs on the primary network interface to serve its DNS server.
When you run the Client Agent alongside the PAN-GP VPN, the primary network interface will likely be set to a `tun` type interface, which the Client Agent cannot use for its IP addresses.
You may see errors such as the following in the `boundary-client-agent.log` file or the `boundary client-agent status` command response:

```
[ERROR] macos.addIP: error adding ipv4 address: ifconfig: ioctl (SIOCAIFADDR): Destination address required
```

To work around the default `tun` interface, you must provide an explicit network interface using the `interface_to_use` configuration option. For example:

```hcl
interface_to_use=en0
```

The `interface_to_use` option allows the Client Agent to create the IPs it needs to serve the DNS server and proxy traffic.
You must restart the Client Agent for it to update its configuration with the new setting.

### Windows

On Windows, the Client Agent may be able to create the IPs that it needs on the primary network interface, but it fails to establish any transparent sessions. You may see the following message:

```
[INFO] default route change detected, restarting
```

You must explicitly specify a network interface to use other than the primary one. You can list available network interfaces using the Powershell command `Get-NetAdapter`, or the older `route print` command. You must find the index of the interface you would normally use to connect to the internet. In this example, the interface index is `11`:

```
PS C:\> Get-NetAdapter
Name                      InterfaceDescription                    ifIndex Status       MacAddress             LinkSpeed
----                      --------------------                    ------- ------       ----------             ---------
Ethernet                  Parallels VirtIO Ethernet Adapter            11 Up           00-1C-42-B3-F2-75        10 Gbps
Ethernet 2                PANGP Virtual Ethernet Adapter Secure        24 Up           02-50-41-00-00-01         2 Gbps
```

Alternatively, if you use `route print`, refer to the following example:

```
PS C:\> route print
===========================================================================
Interface List
 24...02 50 41 00 00 01 ......PANGP Virtual Ethernet Adapter Secure
 11...00 1c 42 b3 f2 75 ......Parallels VirtIO Ethernet Adapter
  1...........................Software Loopback Interface 1
===========================================================================
````

Your configuration should look like this:

```hcl
interface_to_use=11
```

You must restart the Client Agent for it to update its configuration with the new setting.

### Cloudflare WARP client

The Cloudflare WARP client uses a local DNS server to direct traffic.
It has built-in checks to prevent it from being run alongside other software that uses the same mechanism.
This includes the Boundary Client Agent.
If you try to use the Client Agent with the Cloudflare WARP client, it may work, or you may see an error like this one:

```
Status: Unable to Connect
Error reason: DNS Proxy Failure
Error code: CF_DNS_PROXY_FAILURE
Error description: The WARP Agent must be the only process responsible for DNS resolution on the device. One or more processes are already bound to port 53: boundary-client-agent.
Learn more: https://cfl.re/CF_DNS_PROXY_FAILURE
```

You can still install both the Cloudflare WARP client and the Boundary Client Agent on the same machine.
As long as you don't run both at the same time, they should work as expected.

## Frequently asked questions

**Where is the configuration file for the Boundary Client Agent?**

MacOS

  ```shell-session

   /Library/Application Support/HashiCorp/Boundary/boundary-client-agent.hcl

   ```

Windows

  ```shell-session

   C:\Program Files\Hashicorp Boundary\boundary-client-agent.hcl

   ```

Fields include:

_interface_to_use:_ Used to specify interface instead of the default
```hcl
interface_to_use=en1
```

_v4_prefix:_ Specify an alternate prefix to use for generating IPs. Currently must be between /8 and /16
```hcl
v4_prefix=1.1.1.1/8
```

_recurse_only:_ Only recurse the DNS request, do not proxy sessions
```hcl
recurse_only=false
```

_log_to_stdout:_ log to STDOUT in addition to the boundary-client-agent.log file
```hcl
log_to_stdout=false
```

_log_file:_ Specify where to write the Boundary Client Agent logfile to
```hcl
log_file="/Library/Application\ /Support/HashiCorp/Boundary/boundary-client-agent.log"
```

_state_file:_ Specify where to write the Boundary Client Agent state file to. This is an ephemeral file which is removed on successful shutdown.
```hcl
state_file="/Library/Application\ /Support/HashiCorp/Boundary/boundary-client-agent-state.json"
```

_log_level:_ Specify the Verbosity of the Client Agent logs
```hcl
log_level=DEBUG
```

_dns_request_timeout:_ Duration the client will wait for a response to a DNS request
```hcl
dns_request_timeout=300s
```

_override_upstream_dns_servers:_ List of DNS servers that should be used for recursing non-Boundary request, overriding those configured on the system.
```hcl
override_upstream_dns_servers = ["8.8.8.8", "8.8.4.4"]
```

## More information

Refer to the following topics for more information:

- [Aliases](/boundary/docs/concepts/aliases)
- [Boundary Client Agent](/boundary/docs/api-clients/client-agent)