# RDP credential injection compatibility

> **⚠️ BETA FEATURE**
> 
> RDP credential injection is currently in **beta** as of Boundary release 0.20. This feature is under active development and testing.
> 
> **Important considerations:**
> - The compatibility matrix below reflects currently tested configurations.
> - Additional client/target combinations are being validated and will be added regularly.
> - Some functionality may change before general availability.
> - Please report any issues or untested combinations through [official support channels](https://support.hashicorp.com).
> 
> This documentation will be updated frequently as new combinations are tested and validated.

> **Key Takeaways for RDP Credential Injection (Beta)**
>
> * **Credential Source:** The initial beta only supports Boundary's built-in **static credential store** and Vault's Key Value store. Vault LDAP Secrets Engine support is planned as a fast-follow release.
> * **Supported Authentication:** Only **Kerberos** and **NTLMv2** are supported.
> * **Unsupported Authentication:** Microsoft Entra ID, passwordless methods (Windows Hello, FIDO2), and Smart Cards are **not** supported.
> * **Transparent Sessions (TS):** RDP TS on Windows clients requires a custom port configuration due to a conflict with the default port `3389`. See workarounds below.
> * **Initial Connection:** Users must manually accept a self-signed certificate on their first connection to a target.
> * **Important Configuration Note:** The `connection limit` for RDP targets **must not** be set to `1`. A setting of 2 or higher is required.

## How Credential Injection Works

When users connect to RDP targets, Boundary can automatically inject credentials, preventing exposure to the end-user. This is the most secure workflow, providing a passwordless experience within the supported authentication frameworks.

Boundary retrieves credentials from a supported credential store and injects them directly into the RDP session on behalf of the user. **For the initial beta release, the only supported credential source is Boundary's internal static credential store and the Vault KV store.** Support for the Vault LDAP Secrets Engine, is planned as a fast-follow release.

### Supported Authentication Methods

As of Boundary 0.20, we **only** support the following traditional authentication methods for RDP targets:

1.  **Kerberos authentication** - The primary method for domain-joined Windows servers.
2.  **NTLMv2 authentication** - Used for standalone servers or as a fallback.

> **Important: Unsupported Methods**
> Modern and cloud-based authentication methods are **not supported** at this time. This includes, but is not limited to:
> - Microsoft Entra ID (formerly Azure Active Directory)
> - Passwordless methods (Windows Hello, FIDO2 keys)
> - Certificate-based authentication (including Smart Cards)

## Known Limitations

The following issues may affect RDP connections, particularly when using Transparent Sessions:

- **Concurrent Session Hanging:** Attempting to launch more than one concurrent Transparent Session for RDP will cause the Boundary desktop client to hang silently. You must fully terminate the first session before starting another.
- **Improper Session Termination:** Closing the RDP client window does not always properly terminate the underlying Boundary session. This can prevent new connections and contributes to the hanging issue described above. 
- **Transparent Sessions on Windows:** Transparent Sessions for RDP do not work out-of-the-box on modern Windows clients (Windows 11+) due to a port conflict. See the workarounds in the Configuration Requirements section below.
- Intermittent connection failures may occur with Kerberos authentication.
- Some Kerberos authentication events may not be properly logged.

Boundary engineering is closely tracking these issues and will fix them in subsequent patch releases.

## Configuration Requirements

### Using Transparent Sessions with RDP on Windows

Due to a port conflict on modern Windows operating systems (Windows 11+), Transparent Sessions (TS) cannot use the default RDP port (`3389`). This prevents users from connecting by simply entering a target alias in their RDP client.

To connect to an RDP target using a Transparent Session from a Windows client, you **must** use a custom port. Two primary workarounds are available:

1.  **Configure a Default Client Port:** Set a custom port (e.g., `83389`) in the target's configuration within Boundary. The user must then connect by specifying this port in their RDP client (e.g., `my-server:83389`).
2.  **Use `.rdp` Bookmark Files:** Create and distribute an `.rdp` file that contains the full connection string, including the custom port for the localhost listener (e.g., `full address:s:localhost:51129`). This allows users to connect by simply opening the file.

### Certificate handling

Boundary generates self-signed certificates for each RDP target. When users first connect to a target, they must manually accept the certificate. This is a one-time action per target for most clients, though behavior varies:

- **Windows clients** remember certificates across sessions.
- **macOS clients** require accepting certificates per alias or endpoint.
- **Custom listen addresses** generate certificate mismatch warnings.

Future releases may support enterprise certificate authorities for trusted certificates.

### Connection limits

The Windows Remote Desktop Connection application consumes multiple connections when initiating a session.

> **⚠️ Critical Configuration**
> Do not set the connection limit to `1` for RDP targets. This will cause all RDP connections to fail. You must configure a limit of 2 or higher to account for the multiple connections used by the RDP client.

### Network configuration

RDP credential injection has specific network requirements:

- The standard RDP port is 3389 (configurable for non-standard ports).
- Port 127.0.0.1:3389 is blocked on Windows (use alternative addresses).
- UDP transport is disabled.
- Server redirection is not supported.
- The maximum TLS version is 1.2 (TLS 1.3 is incompatible with Windows Server 2025).

### Client behavior

Different RDP clients exhibit unique behaviors:

**Windows Remote Desktop Connection:**
- Does not prompt for credentials when Boundary injects them.

**macOS Windows App:**
- Prompts for credentials that are ignored (Boundary injects the stored credential regardless).
- Requires manual certificate acceptance per endpoint.

## Compatibility Status

### Compatibility Status Legend
* **✅:** Tested and verified to be compatible.
* **Pending:** Validation is planned but not yet complete.

### Windows Server 2025

| Client OS | Kerberos only | Kerberos + NTLMv2 (domain-joined worker) | Kerberos + NTLMv2 (non-domain worker) |
|-----------|:-------------:|:----------------------------------------:|:--------------------------------------:|
| Windows 11 | Pending | ✅ | Pending |
| Windows 10 | ✅ | Pending | Pending |
| macOS 15 | Pending | Pending | Pending |
| macOS 14 | Pending | Pending | Pending |
| macOS 13 | Pending | Pending | Pending |

### Windows Server 2022

| Client OS | Kerberos only | Kerberos + NTLMv2 (domain-joined worker) | Kerberos + NTLMv2 (non-domain worker) |
|-----------|:-------------:|:----------------------------------------:|:--------------------------------------:|
| Windows 11 | ✅ | ✅ | ✅ |
| Windows 10 | ✅ | ✅ | ✅ |
| macOS 15 | Pending | ✅ | ✅ |
| macOS 14 | Pending | Pending | Pending |
| macOS 13 | Pending | Pending | Pending |

### Windows Server 2019

| Client OS | Kerberos only | Kerberos + NTLMv2 (domain-joined worker) | Kerberos + NTLMv2 (non-domain worker) |
|-----------|:-------------:|:----------------------------------------:|:--------------------------------------:|
| Windows 11 | ✅ | ✅ | ✅ |
| Windows 10 | ✅ | ✅ | ✅ |
| macOS 15 | ✅ | ✅ | ✅ |
| macOS 14 | Pending | Pending | Pending |
| macOS 13 | Pending | Pending | Pending |

### Windows Server 2016

| Client OS | Kerberos only | Kerberos + NTLMv2 (domain-joined worker) | Kerberos + NTLMv2 (non-domain worker) |
|-----------|:-------------:|:----------------------------------------:|:--------------------------------------:|
| Windows 11 | Pending | ✅ | ✅ |
| Windows 10 | ✅ | ✅ | Pending |
| macOS 15 | ✅ | ✅ | ✅ |
| macOS 14 | Pending | Pending | Pending |
| macOS 13 | Pending | Pending | Pending |

## Quick Troubleshooting and FAQ

**Q: Can I use credentials from my Vault or Active Directory for this feature?**
A: Not yet. The initial beta only supports credentials stored in Boundary's static credential store. Support for the Vault LDAP Secrets Engine is a high-priority addition planned for a fast-follow release.

**Q: Why am I getting a certificate warning when I connect?**
A: This is expected behavior. Boundary generates a self-signed certificate for each RDP target. You must accept this certificate on your first connection.

**Q: My connection is failing immediately. What should I check first?**
A: Check the `connection limit` on your target. It cannot be set to `1`. Set it to 2 or higher.

**Q: Why can't I connect to my RDP Transparent Session on Windows by just using its name?**
A: Modern Windows versions block local applications from using the default RDP port (3389). You must use a workaround, such as connecting to a custom port or using a pre-configured `.rdp` file. See the "Using Transparent Sessions with RDP on Windows" section above.

**Q: My desktop client hung after I tried to open a second RDP session. What do I do?**
A: This is a known issue. The client currently does not support more than one concurrent RDP Transparent Session. You must ensure your first session is completely terminated before starting a new one.

**Q: Does this work with servers that require Entra ID login?**
A: No. At this time, only servers using traditional Kerberos or NTLMv2 authentication are supported.

**Q: The macOS RDP client is asking for a password. Is injection not working?**
A: This is a known behavior of the macOS client. You can leave the password field blank and proceed; Boundary will still inject the correct credentials in the background.
